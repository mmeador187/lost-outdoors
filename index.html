<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lost Outdoors - MVP Map</title>
  <link
    href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css"
    rel="stylesheet"
  />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: sans-serif;
    }
    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
    .sidebar {
      position: absolute;
      top: 10px;
      left: 10px;
      background: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      z-index: 1;
    }
    .weather, .gear-list {
      margin-top: 10px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="sidebar">
    <h3>Lost Outdoors</h3>
    <div class="weather">Weather: <span id="weather"></span></div>
    <h4>Trail Layers</h4>
<label><input type="checkbox" id="toggle-mvum" checked> Show MVUM Layer</label>
<label><input type="checkbox" id="toggle-hiker" checked> Hiker Trails</label><br>
<label><input type="checkbox" id="toggle-bike" checked> Bike Trails</label><br>
<label><input type="checkbox" id="toggle-horse" checked> Horse Trails</label>
    <div class="gear-list">
      <h4>Gear Checklist</h4>
      <ul>
        <li><input type="checkbox" /> Tent</li>
        <li><input type="checkbox" /> Sleeping Bag</li>
        <li><input type="checkbox" /> Water Filter</li>
        <li><input type="checkbox" /> Map / Compass</li>
      </ul>
    </div>
  </div>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibW1lYWRvcjE4NyIsImEiOiJjbWMyNzY0eXkwNWIyMmtxOGhrdndiNmwxIn0.ielEabL7E9CJEf5E9baQ4Q';
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/outdoors-v12',
      center: [-88.688, 37.5], // Horse Gap general area
      zoom: 12
    });

    map.addControl(new mapboxgl.NavigationControl());

map.on('load', () => {
  map.addSource('trails', {
    type: 'geojson',
    data: '/data/TrailsGeoJson.json'
  });

  map.addSource('mvum', {
    type: 'geojson',
    data: '/data/MVUM.json'
  });

  // Hiking Trails
 map.addLayer({
  id: 'trails-hiker',
  type: 'line',
  source: 'trails',
  filter: ['in', 'type2', 
    'Hiker Only Forest Service Trail',
    'Hiker/Equestrian Forest Service Trail',
    'Hiker/Mountain Bike Forest Service Trail'
  ],
  paint: {
    'line-color': '#28a745', // green
    'line-width': 3
  }
});
  // Horse Trails
  map.addLayer({
  id: 'trails-horse',
  type: 'line',
  source: 'trails',
  filter: ['in', ['get', 'type2'],
    'Hiker/Equestrian Forest Service Trail'
  ],
  paint: {
    'line-color': '#a0522d', // brown
    'line-width': 2,
    'line-offset': -2 // Slight
    }
  });

  //Mountain bike trails
  map.addLayer({
    id: 'trails-bike',
    type: 'line',
    source: 'trails',
    filter: ['==', ['get', 'Type2'], 'Hiker/Mountain Bike Forest Service Trail'],
    paint: {
      'line-color': '#ffc107',
      'line-width': 2
    }
  });

//MVUM Layer
  map.addLayer({
    id: 'mvum-layer',
    type: 'line',
    source: 'mvum',
    paint: {
      'line-color': '#00704A',
      'line-width': 2
    },
      layout: {
  visibility: 'none' 
    }
  });
const mvumCheckbox = document.getElementById('toggle-mvum');
const isMVUMChecked = mvumCheckbox.checked;
map.setLayoutProperty('mvum-layer', 'visibility', isMVUMChecked ? 'visible' : 'none');

  // Toggle logic
  const checkbox = document.getElementById('toggle-mvum');
  checkbox.addEventListener('change', function () {
    const visible = checkbox.checked;
    map.setLayoutProperty('mvum-layer', 'visibility', visible ? 'visible' : 'none');

    });
document.getElementById('toggle-hiker').onchange = function(e) {
  map.setLayoutProperty('trails-hiker', 'visibility',
    e.target.checked ? 'visible' : 'none');
};

document.getElementById('toggle-bike').onchange = function(e) {
  map.setLayoutProperty('trails-bike', 'visibility',
    e.target.checked ? 'visible' : 'none');
};

document.getElementById('toggle-horse').onchange = function(e) {
  map.setLayoutProperty('trails-horse', 'visibility',
    e.target.checked ? 'visible' : 'none');
};
  

    map.on('click', (e) => {
      new mapboxgl.Marker()
        .setLngLat(e.lngLat)
        .addTo(map);
    });

    // Weather API integration
    fetch('https://api.openweathermap.org/data/2.5/weather?lat=37.5&lon=-88.688&appid=374a4a81fc726009ff89323415d557e5&units=imperial')
      .then(res => res.json())
      .then(data => {
        document.getElementById('weather').innerText = `${data.weather[0].main}, ${data.main.temp.toFixed(0)}Â°F`;
      });
   
});
  </script>
</body>
</html>
